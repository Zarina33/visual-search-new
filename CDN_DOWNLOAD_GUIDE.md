# üì• –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ CDN

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ BakaiMarket CDN –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. `download_images_from_cdn.py` 
**–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL**

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ CDN.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ (–Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å API –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- PostgreSQL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ë–î

### 2. `download_images_direct_from_cdn_api.py`
**–ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ CDN API**

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ CDN API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∑–∞—Ç–µ–º —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç —Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ API
- ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- CDN API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω
- –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã credentials –¥–ª—è API

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env`

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —Ñ–∞–π–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```bash
# CDN API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
BAKAI_CDN_API_URL=https://api-cdn.bakai.store
BAKAI_CDN_ACCESS_KEY=your_access_key_here
BAKAI_CDN_SECRET_KEY=your_secret_key_here

# PostgreSQL (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=visual_search
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_password
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ CDN

```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CDN API
poetry run python scripts/test_bakai_cdn.py
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ú–µ—Ç–æ–¥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø—Ä–æ–ø—É—Å–∫–∞—è —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ)
poetry run python scripts/download_images_from_cdn.py

# –£–∫–∞–∑–∞—Ç—å —Å–≤–æ–π –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
poetry run python scripts/download_images_from_cdn.py --output /path/to/images

# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
poetry run python scripts/download_images_from_cdn.py --category electronics

# –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–ø–µ—Ä–≤—ã–µ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
poetry run python scripts/download_images_from_cdn.py --limit 100

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ (–≤–∫–ª—é—á–∞—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
poetry run python scripts/download_images_from_cdn.py --no-skip-existing
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `--output` | –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | `/home/zarina/Work/bektemir_comp/BakaiMarket/bakai_cdn_images` |
| `--no-skip-existing` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã | `False` |
| `--category` | –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é | –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| `--limit` | –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–¥–ª—è —Ç–µ—Å—Ç–∞) | –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π |

### –ú–µ—Ç–æ–¥ 2: –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ API

#### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ API
poetry run python scripts/download_images_direct_from_cdn_api.py

# –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–ø–µ—Ä–≤—ã–µ 50 —Ç–æ–≤–∞—Ä–æ–≤)
poetry run python scripts/download_images_direct_from_cdn_api.py --limit 50

# –£–∫–∞–∑–∞—Ç—å —Å–≤–æ–π –ø—É—Ç—å
poetry run python scripts/download_images_direct_from_cdn_api.py --output /path/to/images

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ
poetry run python scripts/download_images_direct_from_cdn_api.py --no-skip-existing
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `--output` | –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è | `/home/zarina/Work/bektemir_comp/BakaiMarket/bakai_cdn_images` |
| `--no-skip-existing` | –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ | `False` |
| `--limit` | –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ | –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```
bakai_cdn_images/
‚îú‚îÄ‚îÄ electronics/
‚îÇ   ‚îú‚îÄ‚îÄ bakai_12345.jpg
‚îÇ   ‚îú‚îÄ‚îÄ bakai_12346.jpg
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ clothing/
‚îÇ   ‚îú‚îÄ‚îÄ bakai_67890.jpg
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ home_goods/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ uncategorized/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ .download_checkpoint.json  # Checkpoint –¥–ª—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üìÅ –§–∞–π–ª—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- üè∑Ô∏è –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç `external_id` —Ç–æ–≤–∞—Ä–æ–≤
- üì∏ –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ JPEG (–∫–∞—á–µ—Å—Ç–≤–æ 95%)
- üíæ Checkpoint –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –ø–æ—Å–ª–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä–≤–∞–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

–ï—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –±—ã–ª–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞, —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç –µ—ë —Å –º–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
# –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞ - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ
poetry run python scripts/download_images_from_cdn.py
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫—É
poetry run python scripts/download_images_from_cdn.py --category electronics

# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–µ–∂–¥—É
poetry run python scripts/download_images_from_cdn.py --category clothing
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:

```
üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê
======================================================================

‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 15000/15500
‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –µ—Å—Ç—å): 500
‚ùå –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏: 250
‚ö†Ô∏è  –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 50

‚è±Ô∏è  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 1234.56 —Å–µ–∫ (20.58 –º–∏–Ω)
üìà –°–∫–æ—Ä–æ—Å—Ç—å: 12.15 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/—Å–µ–∫

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
   electronics: 5000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   clothing: 4500 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   home_goods: 3200 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   ...
```

---

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ. –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ –≤ –∫–æ–¥–µ:

```python
# –í –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞
BATCH_SIZE = 20  # –£–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤)
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (< 50px)
- ‚úÖ –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (> 20MB)
- ‚úÖ –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (JPEG)

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ CDN API

```bash
‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ CDN API!
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` —Ñ–∞–π–ª:
   - `BAKAI_CDN_API_URL`
   - `BAKAI_CDN_ACCESS_KEY`
   - `BAKAI_CDN_SECRET_KEY`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API:
   ```bash
   curl https://api-cdn.bakai.store/health
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:
   ```bash
   poetry run python scripts/test_bakai_cdn.py
   ```

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL

```bash
‚ùå Failed to connect to database
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω:
   ```bash
   docker-compose ps postgres
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ credentials –≤ `.env`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–∞–∑—É:
   ```bash
   docker-compose restart postgres
   ```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

**–ü—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

1. **–ú–µ–¥–ª–µ–Ω–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**
   - –£–º–µ–Ω—å—à–∏—Ç–µ `BATCH_SIZE` –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API**
   - API –º–æ–∂–µ—Ç –∏–º–µ—Ç—å rate limiting
   - –î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∏—Å–∫–æ–º**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ: `df -h`
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSD –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–Ω–æ–≥–æ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```bash
‚ö†Ô∏è  –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 500
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ CDN
- –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç
- –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
tail -f logs/app_$(date +%Y-%m-%d).log
```

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

```bash
# –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
poetry run python scripts/test_bakai_cdn.py

# –®–∞–≥ 2: –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
poetry run python scripts/download_images_direct_from_cdn_api.py --limit 50

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
ls -lh /home/zarina/Work/bektemir_comp/BakaiMarket/bakai_cdn_images/

# –®–∞–≥ 4: –ü–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
poetry run python scripts/download_images_direct_from_cdn_api.py
```

### –ü—Ä–∏–º–µ—Ä 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫—ç—à–∞

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
poetry run python scripts/download_images_from_cdn.py

# –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∂–µ—Ç —Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–æ
```

### –ü—Ä–∏–º–µ—Ä 3: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

```bash
# –¢–æ–ª—å–∫–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞
poetry run python scripts/download_images_from_cdn.py --category electronics

# –¢–æ–ª—å–∫–æ –æ–¥–µ–∂–¥–∞
poetry run python scripts/download_images_from_cdn.py --category clothing
```

### –ü—Ä–∏–º–µ—Ä 4: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

```bash
# –£–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
rm -rf /home/zarina/Work/bektemir_comp/BakaiMarket/bakai_cdn_images/*

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–Ω–æ–≤–æ
poetry run python scripts/download_images_direct_from_cdn_api.py
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### –í —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:

```
–ó–∞–≥—Ä—É–∑–∫–∞: 45%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå             | 4500/10000 [15:30<18:45, 12.3 img/s]
downloaded=4500, failed=25, speed=12.3/s
```

### Checkpoint —Ñ–∞–π–ª

Checkpoint –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤:
```
bakai_cdn_images/.download_checkpoint.json
```

–°–æ–¥–µ—Ä–∂–∏—Ç:
```json
{
  "timestamp": 1700000000.0,
  "downloaded": ["bakai_123", "bakai_456", ...],
  "failed": ["bakai_789", ...]
}
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `download_images_direct_from_cdn_api.py`
2. ‚úÖ –ù–∞—á–Ω–∏—Ç–µ —Å `--limit 100` –¥–ª—è —Ç–µ—Å—Ç–∞
3. ‚úÖ –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –≤ —Ñ–æ–Ω–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤:
   ```bash
   nohup poetry run python scripts/download_images_direct_from_cdn_api.py > download.log 2>&1 &
   ```

### –î–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `download_images_from_cdn.py`
2. ‚úÖ –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron):
   ```bash
   # –î–æ–±–∞–≤–∏—Ç—å –≤ crontab
   0 2 * * * cd /path/to/project && poetry run python scripts/download_images_from_cdn.py
   ```

### –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞:
1. ‚úÖ –ó–∞–≥—Ä—É–∂–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--limit` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–π—Ç–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. üìñ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `logs/app_*.log`
2. üß™ –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `poetry run python scripts/test_bakai_cdn.py`
3. üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º—É: `./check_system.sh`
4. üí¨ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## ‚úÖ Checklist –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ CDN API (`test_bakai_cdn.py`)
- [ ] –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ `df -h`)
- [ ] PostgreSQL –∑–∞–ø—É—â–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–µ—Ä–≤—ã–π —Å–∫—Ä–∏–ø—Ç)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Å `--limit 10`
- [ ] –ü–æ–Ω—è—Ç–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

---

**üéâ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –º–∞—Å—Å–æ–≤–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ CDN!**



